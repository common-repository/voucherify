(()=>{var e,t={408:(e,t,o)=>{"use strict";var n=o(307);const r=window.wc.blocksCheckout;o(742);const c=window.wp.apiFetch;var i=o.n(c),s=o(818);const a={appliedVouchers:{},appliedGiftCards:{},availablePromotions:{all:[],valid:[]},appliedPromotions:{},isLoading:!1},l={addPromotions:e=>({type:"ADD_PROMOTIONS",promotions:e}),doAddPromotion:e=>({type:"ADD_PROMOTION",promotion:e}),doRemovePromotion:e=>({type:"REMOVE_PROMOTION",promotionCode:e}),addVouchers:e=>({type:"ADD_VOUCHERS",vouchers:e}),addAvailablePromotions:e=>({type:"ADD_AVAILABLE_PROMOTIONS",promotions:e}),addGiftCards:e=>({type:"ADD_GIFT_CARDS",vouchers:e}),doAddVoucher:e=>({type:"ADD_VOUCHER",voucher:e}),doAddGiftCard:e=>({type:"ADD_GIFT_CARD",voucher:e}),doRemoveVoucher:e=>({type:"REMOVE_VOUCHER",voucherCode:e}),doRemoveGiftCard:e=>({type:"REMOVE_GIFT_CARD",voucherCode:e}),addPromotion:e=>async({dispatch:t})=>{try{const o=await i()({path:"/voucherify/v1/promotions/apply",method:"POST",data:{code:e},cache:"no-store"});return t.doAddPromotion({[o.code]:{amount:o.amount,name:o.name}}),o}catch(e){return Promise.reject(e)}},removePromotion:e=>async({dispatch:t})=>{try{const o=await i()({path:"/voucherify/v1/promotions/remove/"+encodeURIComponent(e),method:"DELETE",cache:"no-store"});return t.doRemovePromotion(e),o}catch(e){return Promise.reject(e)}},addGiftCard:(e,t)=>async({dispatch:o})=>{try{const n=await i()({path:"/voucherify/v1/gift-cards/apply",method:"POST",data:{code:e,amount:t},cache:"no-store"});return o.doAddGiftCard({[n.code]:n.amount}),n}catch(e){return Promise.reject(e)}},maybeAddVoucher:e=>async({dispatch:t})=>{try{const o=await i()({path:"/voucherify/v1/discount-vouchers/apply",method:"POST",data:{code:e},cache:"no-store"});return"gift"!==o.type&&t.doAddVoucher({[o.code]:o.amount}),o}catch(e){return Promise.reject(e)}},removeVoucher:e=>async({dispatch:t})=>{try{const o=await i()({path:"/voucherify/v1/discount-vouchers/remove/"+encodeURIComponent(e),method:"DELETE",cache:"no-store"});return t.doRemoveVoucher(e),o}catch(e){return Promise.reject(e)}},removeGiftCard:e=>async({dispatch:t})=>{try{const o=await i()({path:"/voucherify/v1/gift-cards/remove/"+encodeURIComponent(e),method:"DELETE",cache:"no-store"});return t.doRemoveGiftCard(e),o}catch(e){return Promise.reject(e)}},fetchFromAPI:e=>({type:"FETCH_FROM_API",path:e})},m=(0,s.createReduxStore)("voucherify",{reducer(e=a,t){switch(t.type){case"ADD_AVAILABLE_PROMOTIONS":return{...e,availablePromotions:{all:t.promotions.all,valid:t.promotions.valid}};case"ADD_VOUCHERS":return{...e,appliedVouchers:{...e.appliedVouchers,...t.vouchers}};case"ADD_VOUCHER":return{...e,appliedVouchers:{...e.appliedVouchers,...t.voucher}};case"ADD_GIFT_CARDS":return{...e,appliedGiftCards:{...e.appliedGiftCards,...t.vouchers}};case"ADD_GIFT_CARD":return{...e,appliedGiftCards:{...e.appliedGiftCards,...t.voucher}};case"REMOVE_VOUCHER":return{...e,appliedVouchers:Object.keys(e.appliedVouchers).filter((e=>e!==t.voucherCode)).reduce(((t,o)=>(t[o]=e.appliedVouchers[o],t)),{})};case"REMOVE_GIFT_CARD":return{...e,appliedGiftCards:Object.keys(e.appliedGiftCards).filter((e=>e!==t.voucherCode)).reduce(((t,o)=>(t[o]=e.appliedGiftCards[o],t)),{})};case"ADD_PROMOTIONS":return{...e,appliedPromotions:{...e.appliedPromotions,...t.promotions}};case"ADD_PROMOTION":return{...e,appliedPromotions:{...e.appliedPromotions,...t.promotion}};case"REMOVE_PROMOTION":return{...e,appliedPromotions:Object.keys(e.appliedPromotions).filter((e=>e!==t.promotionCode)).reduce(((t,o)=>(t[o]=e.appliedPromotions[o],t)),{})}}return e},actions:l,selectors:{getAppliedPromotions(e){const{appliedPromotions:t}=e;return t},getAvailablePromotions(e){const{availablePromotions:t}=e;return t},getAppliedVouchers(e){const{appliedVouchers:t}=e;return t},getAppliedGiftCards(e){const{appliedGiftCards:t}=e;return t},isApplyingVoucher(e){const{isApplyingVoucher:t}=e;return t},isRemovingVoucher(e){const{isRemovingVoucher:t}=e;return t}},controls:{FETCH_FROM_API:e=>i()({path:e.path})},resolvers:{*getAppliedVouchers(){const e=yield l.fetchFromAPI("/voucherify/v1/discount-vouchers");return l.addVouchers(e.applied_vouchers)},*getAppliedGiftCards(){const e=yield l.fetchFromAPI("/voucherify/v1/gift-cards");return l.addGiftCards(e.applied_gift_cards)},*getAppliedPromotions(){const e=yield l.fetchFromAPI("/voucherify/v1/promotions");return l.addPromotions(e.applied_promotions)},*getAvailablePromotions(){const e=yield l.fetchFromAPI("/voucherify/v1/promotions/available");return l.addAvailablePromotions(e)}}});(0,s.register)(m);const u={metadata:{name:"voucherify/coupons-form",parent:["woocommerce/checkout-totals-block"]},component:(0,n.lazy)((()=>Promise.resolve().then(o.bind(o,742))))};(0,r.registerCheckoutBlock)(u)},742:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>_e});const n=window.React,r=(0,n.createContext)(),c=({children:e})=>{const[t,o]=(0,n.useState)("regular"),[c,i]=(0,n.useState)({}),[s,a]=(0,n.useState)({}),[l,m]=(0,n.useState)({}),[u,d]=(0,n.useState)([]),[p,f]=(0,n.useState)([]),[h,v]=(0,n.useState)([]),[b,g]=(0,n.useState)(!0);return(0,n.createElement)(r.Provider,{value:{vouchersForm:t,setVouchersForm:o,appliedVouchersList:s,setAppliedVouchersList:a,giftCardInFlight:c,setGiftCardInFlight:i,appliedGiftCardsList:l,setAppliedGiftCardsList:m,validPromotions:u,setValidPromotions:d,allPromotions:p,setAllPromotions:f,appliedPromotionsList:h,setAppliedPromotionsList:v,isLoading:b,setIsLoading:g}},e)};var i=o(184),s=o.n(i);const a=window.wp.i18n;var l=o(818);const m=()=>{const{vouchersForm:e,setVouchersForm:t,appliedVouchersList:o,setAppliedVouchersList:c,appliedGiftCardsList:i,setAppliedGiftCardsList:s,appliedPromotionsList:m,setAppliedPromotionsList:u,giftCardInFlight:d,setGiftCardInFlight:p,validPromotions:f,setValidPromotions:h,allPromotions:v,setAllPromotions:b,isLoading:g,setIsLoading:w}=(0,n.useContext)(r);(0,l.useSelect)((e=>{const t=e("voucherify");Promise.all([t.getAppliedVouchers(),t.getAppliedGiftCards(),t.getAppliedPromotions(),t.getAvailablePromotions()]).then((([e,t,o,n])=>{var r,i;c(e),s(t),u(o),h(null!==(r=n.valid)&&void 0!==r?r:[]),b(null!==(i=n.all)&&void 0!==i?i:[]),w(!1)}))}));const _=()=>Object.entries(null!=o?o:{}),E=()=>Object.entries(null!=i?i:{}),y=()=>Object.entries(null!=m?m:{}),{addPromotion:k,addGiftCard:A,maybeAddVoucher:P,removeVoucher:C,removeGiftCard:R,removePromotion:L}=(0,l.useDispatch)("voucherify"),{createNotice:S}=(0,l.useDispatch)("core/notices"),O=e=>S("info",e,{id:"coupon-form",type:"snackbar",context:"wc/cart"});return{isAnyPromotionApplied:()=>y().length>0,isAnyVoucherApplied:()=>_().length>0,isAnyGiftCardApplied:()=>E().length>0,getFormType:()=>"gift"===e?"gift":"regular",removeAllVouchers:()=>{w(!0);const e=_().map((([e])=>(e=>C(e).then((()=>(S("info",(0,a.sprintf)(/* translators: %s coupon code. */ /* translators: %s coupon code. */
(0,a.__)('Coupon code "%s" has been removed from your cart.',"woocommerce"),e),{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!0)))).catch((e=>(S("error",e.message,{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!1)))))(e)));return c({}),Promise.all(e).then((e=>(w(!1),e))).catch((e=>{throw w(!1),e}))},removeAllGiftCards:()=>{w(!0);const e=E().map((([e])=>(e=>R(e).then((()=>(S("info",(0,a.sprintf)(/* translators: %s coupon code. */ /* translators: %s coupon code. */
(0,a.__)('Gift card "%s" has been removed from your cart.',"voucherify"),e),{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!0)))).catch((e=>(S("error",e.message,{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!1)))))(e)));return s({}),Promise.all(e).then((e=>(w(!1),e))).catch((e=>{throw w(!1),e}))},removeAllPromotions:()=>{w(!0);const e=y().map((([e,t])=>((e,t)=>L(e).then((()=>(S("info",(0,a.sprintf)(/* translators: %s coupon code. */ /* translators: %s coupon code. */
(0,a.__)('Promotion "%s" has been removed from your cart.',"voucherify"),null!=t?t:e),{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!0)))).catch((e=>(S("error",e.message,{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!1)))))(e,t.name)));return u({}),Promise.all(e).then((e=>(w(!1),e))).catch((e=>{throw w(!1),e}))},addVoucherToList:e=>(w(!0),P(e).then((e=>(w(!1),"gift"!==e.type&&(O((0,a.sprintf)((0,a.__)('Coupon code "%s" has been applied.',"voucherify"),e.code)),c({...o,[e.code]:e.amount})),Promise.resolve(e)))).catch((e=>(w(!1),S("error",e.message,{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!1))))),addGiftCardToList:(e,o)=>(w(!0),A(e,o).then((e=>(w(!1),O((0,a.sprintf)((0,a.__)('Gift card "%s" has been applied with amount %s.',"voucherify"),e.code,e.amount)),s({...i,[e.code]:e.amount}),p({}),t("regular"),Promise.resolve(e)))).catch((e=>(w(!1),S("error",e.message,{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!1))))),addPromotionsToList:e=>(w(!0),k(e).then((e=>{var t;return w(!1),O((0,a.sprintf)((0,a.__)('Promotion "%s" has been applied.',"voucherify"),null!==(t=e.name)&&void 0!==t?t:e.code)),u({...m,[e.code]:{amount:e.amount,name:e.name}}),Promise.resolve(e)})).catch((e=>(w(!1),S("error",e.message,{id:"coupon-form",type:"snackbar",context:"wc/cart"}),Promise.resolve(!1))))),displayGiftCardForm:(e,o,n)=>(p({code:e,balance:o,balanceLocalized:n}),t("gift"),Promise.resolve()),displayRegularForm:()=>(p({}),t("regular"),Promise.resolve()),getAppliedVouchersList:_,getAppliedGiftCardsList:E,getAppliedPromotionsList:y,giftCardInFlight:d,appliedVouchersList:o,appliedGiftCardsList:i,getValidPromotions:()=>null!=f?f:[],getAllPromotions:()=>null!=v?v:[],isLoading:g}},u=window.wc.wcBlocksData;var d=o(307);const p=window.wp.htmlEntities;function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},f.apply(this,arguments)}const h=window.lodash,v=window.wp.deprecated;var b=o.n(v);const g=window.wp.compose,w=window.wp.dom,_=window.wp.primitives,E=(0,d.createElement)(_.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,d.createElement)(_.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"}));function y(e,t,o){const{defaultView:n}=t,{frameElement:r}=n;if(!r||t===o.ownerDocument)return e;const c=r.getBoundingClientRect();return new n.DOMRect(e.left+c.left,e.top+c.top,e.width,e.height)}let k=0;function A(e){const t=document.scrollingElement||document.body;e&&(k=t.scrollTop);const o=e?"add":"remove";t.classList[o]("lockscroll"),document.documentElement.classList[o]("lockscroll"),e||(t.scrollTop=k)}let P=0;function C(){return(0,d.useEffect)((()=>(0===P&&A(!0),++P,()=>{1===P&&A(!1),--P})),[]),null}window.wp.warning;const R=(0,d.createContext)({slots:{},fills:{},registerSlot:()=>{"undefined"!=typeof process&&process.env},updateSlot:()=>{},unregisterSlot:()=>{},registerFill:()=>{},unregisterFill:()=>{}});function L(e){const t=(0,d.useContext)(R),o=t.slots[e]||{},n=t.fills[e],r=(0,d.useMemo)((()=>n||[]),[n]);return{...o,updateSlot:(0,d.useCallback)((o=>{t.updateSlot(e,o)}),[e,t.updateSlot]),unregisterSlot:(0,d.useCallback)((o=>{t.unregisterSlot(e,o)}),[e,t.unregisterSlot]),fills:r,registerFill:(0,d.useCallback)((o=>{t.registerFill(e,o)}),[e,t.registerFill]),unregisterFill:(0,d.useCallback)((o=>{t.unregisterFill(e,o)}),[e,t.unregisterFill])}}const S=(0,d.createContext)({registerSlot:()=>{},unregisterSlot:()=>{},registerFill:()=>{},unregisterFill:()=>{},getSlot:()=>{},getFills:()=>{},subscribe:()=>{}});function O({name:e,children:t,registerFill:o,unregisterFill:n}){const r=(e=>{const{getSlot:t,subscribe:o}=(0,d.useContext)(S),[n,r]=(0,d.useState)(t(e));return(0,d.useEffect)((()=>(r(t(e)),o((()=>{r(t(e))})))),[e]),n})(e),c=(0,d.useRef)({name:e,children:t});return(0,d.useLayoutEffect)((()=>(o(e,c.current),()=>n(e,c.current))),[]),(0,d.useLayoutEffect)((()=>{c.current.children=t,r&&r.forceUpdate()}),[t]),(0,d.useLayoutEffect)((()=>{e!==c.current.name&&(n(c.current.name,c.current),c.current.name=e,o(e,c.current))}),[e]),r&&r.node?((0,h.isFunction)(t)&&(t=t(r.props.fillProps)),(0,d.createPortal)(t,r.node)):null}const V=e=>(0,d.createElement)(S.Consumer,null,(({registerFill:t,unregisterFill:o})=>(0,d.createElement)(O,f({},e,{registerFill:t,unregisterFill:o}))));class N extends d.Component{constructor(){super(...arguments),this.isUnmounted=!1,this.bindNode=this.bindNode.bind(this)}componentDidMount(){const{registerSlot:e}=this.props;e(this.props.name,this)}componentWillUnmount(){const{unregisterSlot:e}=this.props;this.isUnmounted=!0,e(this.props.name,this)}componentDidUpdate(e){const{name:t,unregisterSlot:o,registerSlot:n}=this.props;e.name!==t&&(o(e.name),n(t,this))}bindNode(e){this.node=e}forceUpdate(){this.isUnmounted||super.forceUpdate()}render(){const{children:e,name:t,fillProps:o={},getFills:n}=this.props,r=(0,h.map)(n(t,this),(e=>{const t=(0,h.isFunction)(e.children)?e.children(o):e.children;return d.Children.map(t,((e,t)=>{if(!e||(0,h.isString)(e))return e;const o=e.key||t;return(0,d.cloneElement)(e,{key:o})}))})).filter((0,h.negate)(d.isEmptyElement));return(0,d.createElement)(d.Fragment,null,(0,h.isFunction)(e)?e(r):r)}}const F=e=>(0,d.createElement)(S.Consumer,null,(({registerSlot:t,unregisterSlot:o,getFills:n})=>(0,d.createElement)(N,f({},e,{registerSlot:t,unregisterSlot:o,getFills:n}))));function x(){const[,e]=(0,d.useState)({}),t=(0,d.useRef)(!0);return(0,d.useEffect)((()=>()=>{t.current=!1}),[]),()=>{t.current&&e({})}}function D({name:e,children:t}){const o=L(e),n=(0,d.useRef)({rerender:x()});return(0,d.useEffect)((()=>(o.registerFill(n),()=>{o.unregisterFill(n)})),[o.registerFill,o.unregisterFill]),o.ref&&o.ref.current?("function"==typeof t&&(t=t(o.fillProps)),(0,d.createPortal)(t,o.ref.current)):null}const T=(0,d.forwardRef)((function({name:e,fillProps:t={},as:o="div",...n},r){const c=(0,d.useContext)(R),i=(0,d.useRef)();return(0,d.useLayoutEffect)((()=>(c.registerSlot(e,i,t),()=>{c.unregisterSlot(e,i)})),[c.registerSlot,c.unregisterSlot,e]),(0,d.useLayoutEffect)((()=>{c.updateSlot(e,t)})),(0,d.createElement)(o,f({ref:(0,g.useMergeRefs)([r,i])},n))}));function I(e){return(0,d.createElement)(d.Fragment,null,(0,d.createElement)(V,e),(0,d.createElement)(D,e))}const G=(0,d.forwardRef)((({bubblesVirtually:e,...t},o)=>e?(0,d.createElement)(T,f({},t,{ref:o})):(0,d.createElement)(F,t)));function M(e){return"appear"===e?"top":"left"}const j="Popover";function H(e,t){const{paddingTop:o,paddingBottom:n,paddingLeft:r,paddingRight:c}=(i=t).ownerDocument.defaultView.getComputedStyle(i);var i;const s=o?parseInt(o,10):0,a=n?parseInt(n,10):0,l=r?parseInt(r,10):0,m=c?parseInt(c,10):0;return{x:e.left+l,y:e.top+s,width:e.width-l-m,height:e.height-s-a,left:e.left+l,right:e.right-m,top:e.top+s,bottom:e.bottom-a}}function B(e,t,o){o?e.getAttribute(t)!==o&&e.setAttribute(t,o):e.hasAttribute(t)&&e.removeAttribute(t)}function W(e,t,o=""){e.style[t]!==o&&(e.style[t]=o)}function z(e,t,o){o?e.classList.contains(t)||e.classList.add(t):e.classList.contains(t)&&e.classList.remove(t)}const U=(0,d.forwardRef)((({headerTitle:e,onClose:t,children:o,className:n,noArrow:r=!0,isAlternate:c,position:i="bottom right",range:l,focusOnMount:m="firstElement",anchorRef:u,shouldAnchorIncludePadding:p,anchorRect:h,getAnchorRect:v,expandOnMobile:_,animate:k=!0,onClickOutside:A,onFocusOutside:P,__unstableStickyBoundaryElement:R,__unstableSlotName:S=j,__unstableObserveElement:O,__unstableBoundaryParent:V,__unstableForcePosition:N,__unstableForceXAlignment:F,...x},D)=>{const T=(0,d.useRef)(null),G=(0,d.useRef)(null),U=(0,d.useRef)(),K=(0,g.useViewportMatch)("medium","<"),[Y,q]=(0,d.useState)(),X=L(S),J=_&&K,[Q,Z]=(0,g.useResizeObserver)();r=J||r,(0,d.useLayoutEffect)((()=>{if(J)return z(U.current,"is-without-arrow",r),z(U.current,"is-alternate",c),B(U.current,"data-x-axis"),B(U.current,"data-y-axis"),W(U.current,"top"),W(U.current,"left"),W(G.current,"maxHeight"),void W(G.current,"maxWidth");const e=()=>{if(!U.current||!G.current)return;let e=function(e,t,o,n=!1,r,c){if(t)return t;if(o){if(!e.current)return;const t=o(e.current);return y(t,t.ownerDocument||e.current.ownerDocument,c)}if(!1!==n){if(!(n&&window.Range&&window.Element&&window.DOMRect))return;if("function"==typeof(null==n?void 0:n.cloneRange))return y((0,w.getRectangleFromRange)(n),n.endContainer.ownerDocument,c);if("function"==typeof(null==n?void 0:n.getBoundingClientRect)){const e=y(n.getBoundingClientRect(),n.ownerDocument,c);return r?e:H(e,n)}const{top:e,bottom:t}=n,o=e.getBoundingClientRect(),i=t.getBoundingClientRect(),s=y(new window.DOMRect(o.left,o.top,o.width,i.bottom-o.top),e.ownerDocument,c);return r?s:H(s,n)}if(!e.current)return;const{parentNode:i}=e.current,s=i.getBoundingClientRect();return r?s:H(s,i)}(T,h,v,u,p,U.current);if(!e)return;const{offsetParent:t,ownerDocument:o}=U.current;let n,s=0;if(t&&t!==o.body){const o=t.getBoundingClientRect();s=o.top,e=new window.DOMRect(e.left-o.left,e.top-o.top,e.width,e.height)}var l;V&&(n=null===(l=U.current.closest(".popover-slot"))||void 0===l?void 0:l.parentNode);const m=Z.height?Z:G.current.getBoundingClientRect(),{popoverTop:d,popoverLeft:f,xAxis:b,yAxis:g,contentHeight:_,contentWidth:E}=function(e,t,o="top",n,r,c,i,s,l){const[m,u="center",d]=o.split(" "),p=function(e,t,o,n,r,c,i,s){const{height:a}=t;if(r){const t=r.getBoundingClientRect().top+a-i;if(e.top<=t)return{yAxis:o,popoverTop:Math.min(e.bottom,t)}}let l=e.top+e.height/2;"bottom"===n?l=e.bottom:"top"===n&&(l=e.top);const m={popoverTop:l,contentHeight:(l-a/2>0?a/2:l)+(l+a/2>window.innerHeight?window.innerHeight-l:a/2)},u={popoverTop:e.top,contentHeight:e.top-10-a>0?a:e.top-10},d={popoverTop:e.bottom,contentHeight:e.bottom+10+a>window.innerHeight?window.innerHeight-10-e.bottom:a};let p,f=o,h=null;if(!r&&!s)if("middle"===o&&m.contentHeight===a)f="middle";else if("top"===o&&u.contentHeight===a)f="top";else if("bottom"===o&&d.contentHeight===a)f="bottom";else{f=u.contentHeight>d.contentHeight?"top":"bottom";const e="top"===f?u.contentHeight:d.contentHeight;h=e!==a?e:null}return p="middle"===f?m.popoverTop:"top"===f?u.popoverTop:d.popoverTop,{yAxis:f,popoverTop:p,contentHeight:h}}(e,t,m,d,n,0,c,s),f=function(e,t,o,n,r,c,i,s,l){const{width:m}=t;"left"===o&&(0,a.isRTL)()?o="right":"right"===o&&(0,a.isRTL)()&&(o="left"),"left"===n&&(0,a.isRTL)()?n="right":"right"===n&&(0,a.isRTL)()&&(n="left");const u=Math.round(e.left+e.width/2),d={popoverLeft:u,contentWidth:(u-m/2>0?m/2:u)+(u+m/2>window.innerWidth?window.innerWidth-u:m/2)};let p=e.left;"right"===n?p=e.right:"middle"===c||l||(p=u);let f=e.right;"left"===n?f=e.left:"middle"===c||l||(f=u);const h={popoverLeft:p,contentWidth:p-m>0?m:p},v={popoverLeft:f,contentWidth:f+m>window.innerWidth?window.innerWidth-f:m};let b,g=o,w=null;if(!r&&!s)if("center"===o&&d.contentWidth===m)g="center";else if("left"===o&&h.contentWidth===m)g="left";else if("right"===o&&v.contentWidth===m)g="right";else{g=h.contentWidth>v.contentWidth?"left":"right";const e="left"===g?h.contentWidth:v.contentWidth;m>window.innerWidth&&(w=window.innerWidth),e!==m&&(g="center",d.popoverLeft=window.innerWidth/2)}if(b="center"===g?d.popoverLeft:"left"===g?h.popoverLeft:v.popoverLeft,i){const e=i.getBoundingClientRect();b=Math.min(b,e.right-m),(0,a.isRTL)()||(b=Math.max(b,0))}return{xAxis:g,popoverLeft:b,contentWidth:w}}(e,t,u,d,n,p.yAxis,i,s,l);return{...f,...p}}(e,m,i,R,U.current,s,n,N,F);"number"==typeof d&&"number"==typeof f&&(W(U.current,"top",d+"px"),W(U.current,"left",f+"px")),z(U.current,"is-without-arrow",r||"center"===b&&"middle"===g),z(U.current,"is-alternate",c),B(U.current,"data-x-axis",b),B(U.current,"data-y-axis",g),W(G.current,"maxHeight","number"==typeof _?_+"px":""),W(G.current,"maxWidth","number"==typeof E?E+"px":""),q(({left:"right",right:"left"}[b]||"center")+" "+({top:"bottom",bottom:"top"}[g]||"middle"))};e();const{ownerDocument:t}=U.current,{defaultView:o}=t,n=o.setInterval(e,500);let s;const l=()=>{o.cancelAnimationFrame(s),s=o.requestAnimationFrame(e)};o.addEventListener("click",l),o.addEventListener("resize",e),o.addEventListener("scroll",e,!0);const m=function(e){if(e)return e.endContainer?e.endContainer.ownerDocument:e.top?e.top.ownerDocument:e.ownerDocument}(u);let d;return m&&m!==t&&(m.defaultView.addEventListener("resize",e),m.defaultView.addEventListener("scroll",e,!0)),O&&(d=new o.MutationObserver(e),d.observe(O,{attributes:!0})),()=>{o.clearInterval(n),o.removeEventListener("resize",e),o.removeEventListener("scroll",e,!0),o.removeEventListener("click",l),o.cancelAnimationFrame(s),m&&m!==t&&(m.defaultView.removeEventListener("resize",e),m.defaultView.removeEventListener("scroll",e,!0)),d&&d.disconnect()}}),[J,h,v,u,p,i,Z,R,O,V]);const $=(e,o)=>{if("focus-outside"===e&&P)P(o);else if("focus-outside"===e&&A){const e=new window.MouseEvent("click");Object.defineProperty(e,"target",{get:()=>o.relatedTarget}),b()("Popover onClickOutside prop",{since:"5.3",alternative:"onFocusOutside"}),A(e)}else t&&t()},[ee,te]=(0,g.__experimentalUseDialog)({focusOnMount:m,__unstableOnClose:$,onClose:$}),oe=(0,g.useMergeRefs)([U,ee,D]),re=Boolean(k&&Y)&&function(e){if("loading"===e.type)return s()("components-animate__loading");const{type:t,origin:o=M(t)}=e;if("appear"===t){const[e,t="center"]=o.split(" ");return s()("components-animate__appear",{["is-from-"+t]:"center"!==t,["is-from-"+e]:"middle"!==e})}return"slide-in"===t?s()("components-animate__slide-in","is-from-"+o):void 0}({type:"appear",origin:Y});let ce=(0,d.createElement)("div",f({className:s()("components-popover",n,re,{"is-expanded":J,"is-without-arrow":r,"is-alternate":c})},x,{ref:oe},te,{tabIndex:"-1"}),J&&(0,d.createElement)(C,null),J&&(0,d.createElement)("div",{className:"components-popover__header"},(0,d.createElement)("span",{className:"components-popover__header-title"},e),(0,d.createElement)(ne,{className:"components-popover__close",icon:E,onClick:t})),(0,d.createElement)("div",{ref:G,className:"components-popover__content"},(0,d.createElement)("div",{style:{position:"relative"}},Q,o)));return X.ref&&(ce=(0,d.createElement)(I,{name:S},ce)),u||h?ce:(0,d.createElement)("span",{ref:T},ce)}));U.Slot=(0,d.forwardRef)((function({name:e=j},t){return(0,d.createElement)(G,{bubblesVirtually:!0,name:e,className:"popover-slot",ref:t})}));const K=U,Y=function({shortcut:e,className:t}){if(!e)return null;let o,n;return(0,h.isString)(e)&&(o=e),(0,h.isObject)(e)&&(o=e.display,n=e.ariaLabel),(0,d.createElement)("span",{className:t,"aria-label":n},o)},q=(0,d.createElement)("div",{className:"event-catcher"}),X=({eventHandlers:e,child:t,childrenWithPopover:o})=>(0,d.cloneElement)((0,d.createElement)("span",{className:"disabled-element-wrapper"},(0,d.cloneElement)(q,e),(0,d.cloneElement)(t,{children:o}),","),e),J=({child:e,eventHandlers:t,childrenWithPopover:o})=>(0,d.cloneElement)(e,{...t,children:o}),Q=(e,t,o)=>{if(1!==d.Children.count(e))return;const n=d.Children.only(e);"function"==typeof n.props[t]&&n.props[t](o)},Z=function({children:e,position:t,text:o,shortcut:n}){const[r,c]=(0,d.useState)(!1),[i,s]=(0,d.useState)(!1),a=(0,g.useDebounce)(s,700),l=t=>{Q(e,"onMouseDown",t),document.addEventListener("mouseup",p),c(!0)},m=t=>{Q(e,"onMouseUp",t),document.removeEventListener("mouseup",p),c(!1)},u=e=>"mouseUp"===e?m:"mouseDown"===e?l:void 0,p=u("mouseUp"),f=(t,o)=>n=>{if(Q(e,t,n),n.currentTarget.disabled)return;if("focus"===n.type&&r)return;a.cancel();const c=(0,h.includes)(["focus","mouseenter"],n.type);c!==i&&(o?a(c):s(c))},v=()=>{a.cancel(),document.removeEventListener("mouseup",p)};if((0,d.useEffect)((()=>v),[]),1!==d.Children.count(e))return e;const b={onMouseEnter:f("onMouseEnter",!0),onMouseLeave:f("onMouseLeave"),onClick:f("onClick"),onFocus:f("onFocus"),onBlur:f("onBlur"),onMouseDown:u("mouseDown")},w=d.Children.only(e),{children:_,disabled:E}=w.props,y=E?X:J,k=(({grandchildren:e,isOver:t,position:o,text:n,shortcut:r})=>(0,d.concatChildren)(e,t&&(0,d.createElement)(K,{focusOnMount:!1,position:o,className:"components-tooltip","aria-hidden":"true",animate:!1,noArrow:!0},n,(0,d.createElement)(Y,{className:"components-tooltip__shortcut",shortcut:r}))))({grandchildren:_,isOver:i,position:t,text:o,shortcut:n});return y({child:w,eventHandlers:b,childrenWithPopover:k})},$=function({icon:e,className:t,...o}){const n=["dashicon","dashicons","dashicons-"+e,t].filter(Boolean).join(" ");return(0,d.createElement)("span",f({className:n},o))},ee=function({icon:e=null,size:t=24,...o}){if("string"==typeof e)return(0,d.createElement)($,f({icon:e},o));if((0,d.isValidElement)(e)&&$===e.type)return(0,d.cloneElement)(e,{...o});if("function"==typeof e)return e.prototype instanceof d.Component?(0,d.createElement)(e,{size:t,...o}):e({size:t,...o});if(e&&("svg"===e.type||e.type===_.SVG)){const n={width:t,height:t,...e.props,...o};return(0,d.createElement)(_.SVG,n)}return(0,d.isValidElement)(e)?(0,d.cloneElement)(e,{size:t,...o}):e},te=(0,d.forwardRef)((function({as:e="div",className:t,...o},n){return function({as:e="div",...t}){return"function"==typeof t.children?t.children(t):(0,d.createElement)(e,t)}({as:e,className:s()("components-visually-hidden",t),...o,ref:n})})),oe=["onMouseDown","onClick"],ne=(0,d.forwardRef)((function(e,t){const{href:o,target:n,isSmall:r,isPressed:c,isBusy:i,isDestructive:a,className:l,disabled:m,icon:u,iconPosition:p="left",iconSize:v,showTooltip:g,tooltipPosition:w,shortcut:_,label:E,children:y,text:k,variant:A,__experimentalIsFocusable:P,describedBy:C,...R}=function({isDefault:e,isPrimary:t,isSecondary:o,isTertiary:n,isLink:r,variant:c,...i}){let s=c;var a,l,m,u,d;return t&&(null!==(a=s)&&void 0!==a||(s="primary")),n&&(null!==(l=s)&&void 0!==l||(s="tertiary")),o&&(null!==(m=s)&&void 0!==m||(s="secondary")),e&&(b()("Button isDefault prop",{since:"5.4",alternative:'variant="secondary"'}),null!==(u=s)&&void 0!==u||(s="secondary")),r&&(null!==(d=s)&&void 0!==d||(s="link")),{...i,variant:s}}(e),L=s()("components-button",l,{"is-secondary":"secondary"===A,"is-primary":"primary"===A,"is-small":r,"is-tertiary":"tertiary"===A,"is-pressed":c,"is-busy":i,"is-link":"link"===A,"is-destructive":a,"has-text":!!u&&!!y,"has-icon":!!u}),S=m&&!P,O=void 0===o||S?"button":"a",V="a"===O?{href:o,target:n}:{type:"button",disabled:S,"aria-pressed":c};if(m&&P){V["aria-disabled"]=!0;for(const e of oe)R[e]=e=>{e.stopPropagation(),e.preventDefault()}}const N=!S&&(g&&E||_||!!E&&(!y||(0,h.isArray)(y)&&!y.length)&&!1!==g),F=C?(0,h.uniqueId)():null,x=R["aria-describedby"]||F,D=(0,d.createElement)(O,f({},V,R,{className:L,"aria-label":R["aria-label"]||E,"aria-describedby":x,ref:t}),u&&"left"===p&&(0,d.createElement)(ee,{icon:u,size:v}),k&&(0,d.createElement)(d.Fragment,null,k),u&&"right"===p&&(0,d.createElement)(ee,{icon:u,size:v}),y);return N?(0,d.createElement)(d.Fragment,null,(0,d.createElement)(Z,{text:C||E,shortcut:_,position:w},D),C&&(0,d.createElement)(te,null,(0,d.createElement)("span",{id:F},C))):(0,d.createElement)(d.Fragment,null,D,C&&(0,d.createElement)(te,null,(0,d.createElement)("span",{id:F},C)))})),re=()=>(0,n.createElement)("span",{className:"wc-block-components-spinner","aria-hidden":"true"}),ce=({className:e,showSpinner:t=!1,children:o,variant:r="contained",...c})=>{const i=s()("wc-block-components-button","wp-element-button",e,r,{"wc-block-components-button--loading":t});return(0,n.createElement)(ne,{className:i,...c},t&&(0,n.createElement)(re,null),(0,n.createElement)("span",{className:"wc-block-components-button__text"},o))},ie=window.wc.blocksComponents,se=({children:e,className:t,screenReaderLabel:o,showSpinner:r=!1,isLoading:c=!0})=>(0,n.createElement)("div",{className:s()(t,{"wc-block-components-loading-mask":c})},c&&r&&(0,n.createElement)(ie.Spinner,null),(0,n.createElement)("div",{className:s()({"wc-block-components-loading-mask__children":c}),"aria-hidden":c},e),c&&(0,n.createElement)("span",{className:"screen-reader-text"},o||(0,a.__)("Loading…","woocommerce"))),ae=()=>{const{giftCardInFlight:e,displayRegularForm:t,addGiftCardToList:o,isLoading:r}=m(),[c,i]=(0,d.useState)(""),s=e.code,f=e.balance,h=e.balanceLocalized,{setValidationErrors:v}=(0,l.useDispatch)(u.VALIDATION_STORE_KEY),b="wc-block-components-totals-coupon__input-0",{amountValidationErrorId:g,hasValidationErrors:w}=(0,l.useSelect)((e=>{const t=e(u.VALIDATION_STORE_KEY);return{hasValidationErrors:t.hasValidationErrors(),amountValidationErrorId:t.getValidationErrorId(b)}}));return(0,n.createElement)(se,{screenReaderLabel:(0,a.__)("Applying coupon…","woocommerce"),isLoading:r,showSpinner:!1},(0,n.createElement)("div",null,g),(0,n.createElement)("form",{className:"wc-block-components-totals-gift-card__form",id:"wc-block-components-totals-gift-card__form"},(0,n.createElement)("div",{className:"wp-block-woocommerce-cart-order-summary-subtotal-block wc-block-components-totals-wrapper"},(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("span",{className:"wc-block-components-totals-item__label"},(0,a.__)("Gift card","voucherify"),":"),(0,n.createElement)("span",{className:"wc-block-formatted-money-amount wc-block-components-formatted-money-amount wc-block-components-totals-item__value"},s)),(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("span",{className:"wc-block-components-totals-item__label"},(0,a.__)("Available balance","voucherify"),":"),(0,n.createElement)("span",{className:"wc-block-formatted-money-amount wc-block-components-formatted-money-amount wc-block-components-totals-item__value"},h))),(0,n.createElement)(ie.ValidatedTextInput,{id:b,errorId:"giftCardAmount",type:"number",min:"0.01",step:"0.01",max:f,className:"wc-block-components-totals-coupon__input",label:(0,a.__)("Enter amount to apply","voucherify"),value:c,ariaDescribedBy:g,onChange:e=>{i(e)},focusOnMount:!0,validateOnMount:!1,showError:!1}),(0,n.createElement)(ie.ValidationInputError,{propertyName:"giftCardAmount",elementId:b}),(0,n.createElement)("div",{className:"wc-block-components-totals-gift-card__buttons-container"},(0,n.createElement)(ce,{className:"wc-block-components-totals-coupon__button",disabled:r||!c||w,showSpinner:r,onClick:e=>{e.preventDefault(),o(s,c).then((e=>(0,l.dispatch)(u.CART_STORE_KEY).invalidateResolutionForStore())).catch((e=>((e=>{v({coupon:{message:(0,p.decodeEntities)(e.message),hidden:!1}})})(e),Promise.resolve(!1))))},type:"submit"},(0,a.__)("Apply","woocommerce")),(0,n.createElement)(ce,{className:"wc-block-components-totals-coupon__button",showSpinner:r,onClick:()=>{t()},type:"submit"},(0,a.__)("Cancel","woocommerce")))))},le=()=>{const{displayGiftCardForm:e,addVoucherToList:t,isLoading:o}=m(),r="wc-block-components-totals-coupon__input-0",[c,i]=(0,d.useState)(""),{validationErrorId:s}=(0,l.useSelect)((e=>({validationErrorId:e(u.VALIDATION_STORE_KEY).getValidationErrorId(r)}))),{setValidationErrors:f}=(0,l.useDispatch)(u.VALIDATION_STORE_KEY);return(0,n.createElement)(se,{screenReaderLabel:(0,a.__)("Applying coupon…","woocommerce"),isLoading:o,showSpinner:!1},(0,n.createElement)("form",{className:"wc-block-components-totals-coupon__form",id:"wc-block-components-totals-coupon__form"},(0,n.createElement)(ie.ValidatedTextInput,{id:r,errorId:"coupon",className:"wc-block-components-totals-coupon__input",label:(0,a.__)("Enter code","voucherify"),value:c,ariaDescribedBy:s,onChange:e=>{i(e)},focusOnMount:!0,validateOnMount:!1,showError:!1}),(0,n.createElement)(ce,{className:"wc-block-components-totals-coupon__button",disabled:o||!c,showSpinner:o,onClick:o=>{o.preventDefault(),t(c).then((t=>"gift"===t.type?e(t.code,t.balance,t.balance_localized):(0,l.dispatch)(u.CART_STORE_KEY).invalidateResolutionForStore())).catch((e=>((e=>{f({coupon:{message:(0,p.decodeEntities)(e.message),hidden:!1}})})(e),Promise.resolve(!1))))},type:"submit"},(0,a.__)("Apply","woocommerce"))),(0,n.createElement)(ie.ValidationInputError,{propertyName:"coupon",elementId:r}))},me=()=>{const{getFormType:e}=m();return"gift"===e()?(0,n.createElement)(ae,null):(0,n.createElement)("div",{className:s()("wp-block-woocommerce-cart-order-summary-subtotal-block","wc-block-components-totals-wrapper")},(0,n.createElement)(le,null))},ue=window.wc.priceFormat,de=()=>{const{removeAllVouchers:e,getAppliedVouchersList:t,isLoading:o}=m();return(0,n.createElement)("div",{className:"wc-block-components-totals-coupon__content"},(0,n.createElement)("div",{className:s()("wc-block-components-totals-vouchers__content","wc-block-components-totals-discounts__content")},(0,n.createElement)("span",{className:"wp-block-woocommerce-cart-order-summary-heading-block wc-block-cart__totals-title"},(0,a.__)("Applied coupons","voucherify")),(0,n.createElement)("div",{className:s()("wp-block-woocommerce-cart-order-summary-subtotal-block","wc-block-components-totals-wrapper")},(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("ul",{className:"wc-block-components-totals-discount__coupon-list"},t().map((([t,r],c)=>(0,n.createElement)(ie.RemovableChip,{key:"coupon-"+t,className:"wc-block-components-totals-discount__coupon-list-item",text:(0,n.createElement)(n.Fragment,null,t,": ",(0,n.createElement)("span",{className:"amount-deducted"},"-",(0,ue.formatPrice)(100*r))),screenReaderText:(0,a.sprintf)(/* translators: %s Coupon code. */ /* translators: %s Coupon code. */
(0,a.__)("Coupon: %s","woocommerce"),t),disabled:o,onRemove:o=>((t,o)=>{t.preventDefault(),e(o).finally((()=>(0,l.dispatch)(u.CART_STORE_KEY).invalidateResolutionForStore()))})(o,t),radius:"large",ariaLabel:(0,a.sprintf)(/* translators: %s is a coupon code. */ /* translators: %s is a coupon code. */
(0,a.__)('Remove coupon "%s"',"woocommerce"),t)}))))))))},pe=()=>{const{removeAllGiftCards:e,getAppliedPromotionsList:t,removeAllPromotions:o,isLoading:r}=m();return(0,n.createElement)("div",{className:"wc-block-components-totals-coupon__content"},(0,n.createElement)("div",{className:s()("wc-block-components-totals-vouchers__content","wc-block-components-totals-gift-cards__content")},(0,n.createElement)("span",{className:"wp-block-woocommerce-cart-order-summary-heading-block wc-block-cart__totals-title"},(0,a.__)("Applied promotions","voucherify")),(0,n.createElement)("div",{className:s()("wp-block-woocommerce-cart-order-summary-subtotal-block","wc-block-components-totals-wrapper")},(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("ul",{className:"wc-block-components-totals-discount__coupon-list"},t().map((([e,t],c)=>(0,n.createElement)(ie.RemovableChip,{key:"coupon-"+e,className:"wc-block-components-totals-discount__coupon-list-item",text:(0,n.createElement)(n.Fragment,null,"object"==typeof t?t.name:e,":",(0,n.createElement)("span",{className:"amount-deducted"},"-",(0,ue.formatPrice)(100*("object"==typeof t?t.amount:t)))),screenReaderText:(0,a.sprintf)(/* translators: %s Coupon code. */ /* translators: %s Coupon code. */
(0,a.__)("Promotion: %s","voucherify"),"object"==typeof t?t.name:e),disabled:r,onRemove:t=>((e,t)=>{e.preventDefault(),o(t).finally((()=>(0,l.dispatch)(u.CART_STORE_KEY).invalidateResolutionForStore()))})(t,e),radius:"large",ariaLabel:(0,a.sprintf)(/* translators: %s is a coupon code. */ /* translators: %s is a coupon code. */
(0,a.__)('Remove promotion "%s"',"voucherify"),"object"==typeof t?t.name:e)}))))))))},fe=()=>{const{removeAllGiftCards:e,getAppliedGiftCardsList:t,isLoading:o}=m();return(0,n.createElement)("div",{className:"wc-block-components-totals-coupon__content"},(0,n.createElement)("div",{className:s()("wc-block-components-totals-vouchers__content","wc-block-components-totals-gift-cards__content")},(0,n.createElement)("span",{className:"wp-block-woocommerce-cart-order-summary-heading-block wc-block-cart__totals-title"},(0,a.__)("Applied gift cards","voucherify")),(0,n.createElement)("div",{className:s()("wp-block-woocommerce-cart-order-summary-subtotal-block","wc-block-components-totals-wrapper")},(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("ul",{className:"wc-block-components-totals-discount__coupon-list"},t().map((([t,r],c)=>(0,n.createElement)(ie.RemovableChip,{key:"coupon-"+t,className:"wc-block-components-totals-discount__coupon-list-item",text:(0,n.createElement)(n.Fragment,null,t,": ",(0,n.createElement)("span",{className:"amount-deducted"},"-",(0,ue.formatPrice)(100*r))),screenReaderText:(0,a.sprintf)(/* translators: %s Coupon code. */ /* translators: %s Coupon code. */
(0,a.__)("Gift card: %s","voucherify"),t),disabled:o,onRemove:o=>((t,o)=>{t.preventDefault(),e(o).finally((()=>(0,l.dispatch)(u.CART_STORE_KEY).invalidateResolutionForStore()))})(o,t),radius:"large",ariaLabel:(0,a.sprintf)(/* translators: %s is a coupon code. */ /* translators: %s is a coupon code. */
(0,a.__)('Remove gift card "%s"',"voucherify"),t)}))))))))},he=window.wp.components,ve=(0,n.createElement)(_.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)(_.Path,{d:"M4 9v1.5h16V9H4zm12 5.5h4V13h-4v1.5zm-6 0h4V13h-4v1.5zm-6 0h4V13H4v1.5z"})),be=()=>{const{getAllPromotions:e}=m();return(0,n.createElement)(he.Panel,{className:s()("wc-block-components-totals-promotion__available-list")},(0,n.createElement)(he.PanelBody,{title:(0,a.__)("Show all promotions","voucherify"),icon:ve,initialOpen:!1},(0,n.createElement)(he.PanelRow,null,(0,n.createElement)("ul",null,e().filter((e=>null!==e)).map((e=>(0,n.createElement)("li",{key:e},e)))))))},ge=()=>{const{getValidPromotions:e,getAllPromotions:t,addPromotionsToList:o,isLoading:r}=m(),[c,i]=(0,d.useState)(""),[s,p]=(0,d.useState)(!1),[f,h]=(0,d.useState)(!1),{setValidationErrors:v}=(0,l.useDispatch)(u.VALIDATION_STORE_KEY),b=()=>{p(!0),document.querySelector('.wc-block-components-totals-promotion__form input.components-combobox-control__input[type="text"]').classList.add("is-active"),document.querySelector(".wc-block-components-totals-promotion__form .components-base-control__label").classList.add("is-active")},g=()=>{if(p(!1),!f){const e=document.querySelector('.wc-block-components-totals-promotion__form input.components-combobox-control__input[type="text"]');e&&e.classList.remove("is-active");const t=document.querySelector(".wc-block-components-totals-promotion__form .components-base-control__label");t&&t.classList.remove("is-active")}};return(0,d.useEffect)((()=>{const e=document.querySelector('.wc-block-components-totals-promotion__form input.components-combobox-control__input[type="text"]');return e&&(e.addEventListener("focus",b),e.addEventListener("blur",g)),()=>{e&&(e.removeEventListener("focus",b),e.removeEventListener("blur",g))}}),[s,f]),(0,n.createElement)(se,{screenReaderLabel:(0,a.__)("Applying coupon…","woocommerce"),isLoading:r,showSpinner:!1},(0,n.createElement)("form",{className:"wc-block-components-totals-promotion__form",id:"wc-block-components-totals-promotion__form"},(0,n.createElement)(he.ComboboxControl,{label:(0,a.__)("Select available promotion","voucherify"),onChange:e=>{var t;i(e),e=null!==(t=e?.trim())&&void 0!==t?t:"",h(""!==e),[document.querySelector(".wc-block-components-totals-promotion__form .components-base-control__label"),document.querySelector('.wc-block-components-totals-promotion__form input.components-combobox-control__input[type="text"]')].map((t=>{t&&(""!==e||s?t.classList.add("is-active"):t.classList.remove("is-active"))}))},options:e().map((e=>{var t,o;return{value:null!==(t=e.id)&&void 0!==t?t:"",label:null!==(o=e.banner)&&void 0!==o?o:""}})).filter((e=>""!==e.value&&""!==e.label)),value:c}),(0,n.createElement)("div",{className:"wc-block-components-totals-promotion__buttons-container"},(0,n.createElement)(ce,{className:"wc-block-components-totals-promotion__button",disabled:r||!c,showSpinner:r,onClick:e=>{e.preventDefault(),o(c).then((e=>(0,l.dispatch)(u.CART_STORE_KEY).invalidateResolutionForStore())).catch((e=>((e=>{v({coupon:{message:decodeEntities(e.message),hidden:!1}})})(e),Promise.resolve(!1))))},type:"submit"},(0,a.__)("Apply","woocommerce")))),t()?(0,n.createElement)(be,null):null)},we=()=>{const{isAnyVoucherApplied:e,isAnyGiftCardApplied:t,isAnyPromotionApplied:o,getAllPromotions:r,getValidPromotions:c}=m();return e()||t()||o()?(0,n.createElement)(n.Fragment,null,o()?(0,n.createElement)(pe,null):null,e()?(0,n.createElement)(de,null):null,t()?(0,n.createElement)(fe,null):null):(0,n.createElement)(n.Fragment,null,r()||c()?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("span",{className:"wp-block-woocommerce-cart-order-summary-heading-block wc-block-cart__totals-title"},(0,a.__)("Select promotion","voucherify")),(0,n.createElement)("div",{className:s()("wp-block-woocommerce-cart-order-summary-subtotal-block","wc-block-components-totals-wrapper")},(0,n.createElement)(ge,null))):null,(0,n.createElement)("span",{className:"wp-block-woocommerce-cart-order-summary-heading-block wc-block-cart__totals-title"},(0,a.__)("Add coupon or gift card","voucherify")),(0,n.createElement)(me,null))},_e=()=>(0,n.createElement)(c,null,(0,n.createElement)(we,null))},184:(e,t)=>{var o;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var c=typeof o;if("string"===c||"number"===c)e.push(o);else if(Array.isArray(o)){if(o.length){var i=r.apply(null,o);i&&e.push(i)}}else if("object"===c)if(o.toString===Object.prototype.toString)for(var s in o)n.call(o,s)&&o[s]&&e.push(s);else e.push(o.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(o=function(){return r}.apply(t,[]))||(e.exports=o)}()},818:e=>{"use strict";e.exports=window.wp.data},307:e=>{"use strict";e.exports=window.wp.element}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var c=o[e]={exports:{}};return t[e](c,c.exports,n),c.exports}n.m=t,e=[],n.O=(t,o,r,c)=>{if(!o){var i=1/0;for(m=0;m<e.length;m++){for(var[o,r,c]=e[m],s=!0,a=0;a<o.length;a++)(!1&c||i>=c)&&Object.keys(n.O).every((e=>n.O[e](o[a])))?o.splice(a--,1):(s=!1,c<i&&(i=c));if(s){e.splice(m--,1);var l=r();void 0!==l&&(t=l)}}return t}c=c||0;for(var m=e.length;m>0&&e[m-1][2]>c;m--)e[m]=e[m-1];e[m]=[o,r,c]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={692:0,220:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var r,c,[i,s,a]=o,l=0;if(i.some((t=>0!==e[t]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(a)var m=a(n)}for(t&&t(o);l<i.length;l++)c=i[l],n.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return n.O(m)},o=globalThis.webpackChunkcoupons_form=globalThis.webpackChunkcoupons_form||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=n.O(void 0,[220],(()=>n(408)));r=n.O(r)})();
//# sourceMappingURL=view.js.map